name: ğŸ® Build NES Game ROM

on:
  # 'Actions' ã‚¿ãƒ–ã‹ã‚‰æ‰‹å‹•ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
  workflow_dispatch: {}

  # main ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸã¨ãã«ã‚‚å®Ÿè¡Œ
  push:
    branches:
      - main
    paths:
      # ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã®ã¿å®Ÿè¡Œ
      - 'tools/rennda_game_builder.py'
      - '.github/workflows/game_builder.yml'

jobs:
  build-nes-rom:
    runs-on: ubuntu-latest

    steps:
      # 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      - name: Check out repository
        uses: actions/checkout@v4

      # 2. Python ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      - name: Set up Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      
      # 3. ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      # (ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“)
      # - name: Install dependencies
      #   run: pip install ...

      # 4. ã‚²ãƒ¼ãƒ  ROM ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
      - name: Run NES Game Builder script
        run: |
          # å‡ºåŠ›ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
          mkdir -p nes_rom
          
          # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ ROM ã‚’ç”Ÿæˆ
          python tools/rennda_game_builder.py "nes_rom/rennda_game.nes"

      # 5. ç”Ÿæˆã•ã‚ŒãŸ .nes ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€Œã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã€ã¨ã—ã¦ä¿å­˜
      - name: Upload .nes ROM as Artifact
        uses: actions/upload-artifact@v4
        with:
          name: nes-game-rom
          path: nes_rom/rennda_game.nes
